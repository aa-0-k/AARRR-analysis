import pandas as pd
from sqlalchemy import create_engine
import pymysql
import os

# 1ï¸âƒ£ MySQL ì—°ê²° ì„¤ì •
user = "root"  # MySQL ì‚¬ìš©ì ì´ë¦„
password = "****"  # MySQL ë¹„ë°€ë²ˆí˜¸
host = "localhost"  # MySQL ì„œë²„ ì£¼ì†Œ
database = "aarrr"  # ì‚¬ìš©í•  ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„

# SQLAlchemy ì—”ì§„ ìƒì„± (MySQL ì—°ê²°)
engine = create_engine(f"mysql+pymysql://{user}:{password}@{host}/{database}")

# 2ï¸âƒ£ ì—…ë¡œë“œí•  CSV íŒŒì¼ ë¦¬ìŠ¤íŠ¸
#í´ë” ê²½ë¡œ ì§€ì •í•˜ê¸°
path='../AARRRë¶„ì„'
#í•´ë‹¹ í´ë” ì•ˆì— ìˆëŠ” íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°
for file in os.listdir(path):
    if 'csv' in file:
        table_name = file.replace(".csv", "")  # íŒŒì¼ëª…ì—ì„œ í™•ì¥ì ì œê±°í•˜ì—¬ í…Œì´ë¸”ëª…ìœ¼ë¡œ ì‚¬ìš©
        print(file, table_name)
        print(f"ğŸ“Œ {file} â†’ {table_name} í…Œì´ë¸”ë¡œ ì—…ë¡œë“œ ì¤‘...")
            # CSV íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
        df = pd.read_csv(file)
    
        # MySQLì— ë°ì´í„° ë„£ê¸° (ìë™ìœ¼ë¡œ í…Œì´ë¸” ìƒì„±!)
        df.to_sql(name=table_name, con=engine, if_exists="replace", index=False)
    
        print(f"âœ… {table_name} í…Œì´ë¸” ì—…ë¡œë“œ ì™„ë£Œ! \n")
    
print("ğŸ‰ ëª¨ë“  ë°ì´í„° ì—…ë¡œë“œ ì™„ë£Œ!")
